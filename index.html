<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>–ö–ª–∏–∫–µ—Ä –ú–æ–Ω–µ—Ç–∞</title>
<style>
  body {
    text-align: center;
    font-family: Arial, sans-serif;
    margin: 0;
    height: 100vh;
    display: flex;
    flex-direction: column;
    justify-content: center;
    background: #333333;
  }

.coin {
    background-color: #4CAF50;
    border-radius: 50%;
    box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
    width: 300px; /*–†–∞–∑–º–µ—Ä –∫—Ä—É–≥–∞*/
    height: 300px;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 32px;
    color: white;
    cursor: pointer;
    margin: 0 auto;
    margin-top: 120px; /* –ú–µ–Ω—è–µ–º —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –ø–æ –≤–µ—Ä—Ç–∏–∫–∞–ª–∏ */
    transition: background-color 0.1s;
    user-select: none; /* –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ */
  }
  .coin:active {
    background-color: #388E3C;
    transform: scale(0.96); /* –û—Ç—Å–∫–æ–∫ —ç–ª–µ–º–µ–Ω—Ç–∞ –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ */
    transition: transform 0.1s; /* –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∞–Ω–∏–º–∞—Ü–∏–∏ –æ—Ç—Å–∫–æ–∫–∞ */
}

  #balance {
    position: absolute;
    top: 100px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 24px;
    z-index: 10;
  }

</style>
</head>
<body>

<div class="coin" onclick="incrementScore()">–ù–∞–∂–º–∏ –Ω–∞ –º–µ–Ω—è</div>
<div id='balance'>'üí≤' + 0</div>

<script>
function vibrateOnClick() {
  if ("vibrate" in navigator) {
    window.navigator.vibrate(100); // –í–∏–±—Ä–∞—Ü–∏—è –Ω–∞ 100 –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥
  }
}

//–¶–≤–µ—Ç–∞ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–Ω–æ–ø–∫–∏ –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏
var rainbowColors = ['#FF0000', '#FF7F00', '#FFFF00', '#00FF00', '#0000FF', '#4B0082', '#9400D3'];

function incrementScore() {
  balance++;
  document.getElementById('balance').textContent = 'üí≤' + balance;
  vibrateOnClick(); // –í—ã–∑—ã–≤–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –≤–∏–±—Ä–∞—Ü–∏–∏

  var randomColorIndex = Math.floor(Math.random() * 7); // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–ª—É—á–∞–π–Ω—ã–π –∏–Ω–¥–µ–∫—Å
  document.querySelector('.coin').style.backgroundColor = rainbowColors[randomColorIndex]; // –ü—Ä–∏–º–µ–Ω—è–µ–º —Ü–≤–µ—Ç –∫ –∫–Ω–æ–ø–∫–µ
}


{{#content}}
var userid = document.getElementById('userId').innerText;
  
for (i=1; i<2; i++){
               if('{{id}}'==userid){
               balance = '{{balance}}';
               document.getElementById('balance').textContent = 'üí≤' + balance;
               }
}

{{/content}}


// Telegram Mini App –∑–∞—â–∏—Ç–∞ –æ—Ç –∑–∞–∫—Ä—ã—Ç–∏—è –∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –Ω–∞ –≤–µ—Å—å —ç–∫—Ä–∞–Ω
if (window.Telegram.WebApp) {
  Telegram.WebApp.expand(); // –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –Ω–∞ –≤–µ—Å—å —ç–∫—Ä–∞–Ω
  Telegram.WebApp.enableClosingConfirmation(); // –í–∫–ª—é—á–∞–µ–º –¥–∏–∞–ª–æ–≥–æ–≤–æ–µ –æ–∫–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∑–∞–∫—Ä—ã—Ç–∏—è

  // –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è MainButton
  window.Telegram.WebApp.MainButton.setParams({
    text: "–ó–∞–∫—Ä—ã—Ç—å",
    color: "rgb(77, 76, 76)", // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ü–≤–µ—Ç –∫–Ω–æ–ø–∫–∏ –ø–æ RGB (#4d4c4c)
    text_color: "#FFFFFF" // –ë–µ–ª—ã–π —Ü–≤–µ—Ç —Ç–µ–∫—Å—Ç–∞
});
window.Telegram.WebApp.MainButton.show();

        
  // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–±—ã—Ç–∏—è –Ω–∞–∂–∞—Ç–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–Ω—É—é –∫–Ω–æ–ø–∫—É
  window.Telegram.WebApp.MainButton.onClick(function() {
    save();
    window.navigator.vibrate(100);
    showConfirmationDialog();
  });
}

function save(){
  const initDataUnsafe = Telegram.WebApp.initDataUnsafe;
  const userid = initDataUnsafe.user.id;
  

  fetch('https://api.directual.com/good/api/v5/data/WebUser/saveBalance?appID=1e836900-e4dc-4f0c-b73d-fbd01d3ae652&sessionID=yourSessionID', {
    method: 'POST',
    body: JSON.stringify({
        'id': userid,
        'balance': balance
    }),
    headers: {
        'Content-Type': 'application/json'
    },
  }).then(res => res.json())
    .then(data => {
        console.log(data);
    })
    .catch(error => {
        console.error('–û—à–∏–±–∫–∞:', error);
    });
}

function showConfirmationDialog() {
  Telegram.WebApp.showConfirm("üíæ –ü—Ä–æ–≥—Ä–µ—Å—Å —Å–æ—Ö—Ä–∞–Ω—ë–Ω!\n\n–•–æ—Ç–∏—Ç–µ –≤—ã–π—Ç–∏ –∏–∑ –∏–≥—Ä—ã?", function(confirm) {
    if (confirm) {
      Telegram.WebApp.close();
    }
  });
}

// –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–µ—Ä–µ–¥ –∑–∞–∫—Ä—ã—Ç–∏–µ–º –æ–∫–Ω–∞
window.addEventListener('beforeunload', function (e) {
  save();
});

// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥
setInterval(save, 5000);


 </script>

</body>
</html>
